<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>ocde documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">ocde documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">











<ol class="breadcrumb">
  <li>Classes</li>
  <li>NavigationModel</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/editor/editor.component.ts</code>
        </p>





            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#children">children</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Optional</span>
                                <a href="#file">file</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#isFile">isFile</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#title">title</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Optional</span>
                                <a href="#url">url</a>
                            </li>
                        </ul>
                    </td>
                </tr>






        </tbody>
    </table>
</section>


            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="children"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            children</b>
                            <a href="#children"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../classes/NavigationModel.html" target="_self" >NavigationModel[]</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="751" class="link-to-prism">src/app/editor/editor.component.ts:751</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="file"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                                <span class="modifier">Optional</span>
                            file</b>
                            <a href="#file"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../interfaces/File.html" target="_self" >File</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="750" class="link-to-prism">src/app/editor/editor.component.ts:750</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="isFile"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            isFile</b>
                            <a href="#isFile"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="749" class="link-to-prism">src/app/editor/editor.component.ts:749</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="title"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            title</b>
                            <a href="#title"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="747" class="link-to-prism">src/app/editor/editor.component.ts:747</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="url"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                                <span class="modifier">Optional</span>
                            url</b>
                            <a href="#url"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="748" class="link-to-prism">src/app/editor/editor.component.ts:748</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>







    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { AfterViewInit, Component, ElementRef, ViewChild } from &#x27;@angular/core&#x27;;
import { FormGroup,FormBuilder } from &quot;@angular/forms&quot;;
import { RunService } from &#x27;../run.service&#x27;;
import { RunInput } from &#x27;../run_input&#x27;;
import { RenameFile } from &#x27;../renameFile&#x27;;
import { MatDialog } from &#x27;@angular/material/dialog&#x27;;
import { LoginService } from &quot;../login.service&quot;;

import * as ace from &#x27;ace-builds&#x27;;
import &#x27;ace-builds/src-noconflict/mode-c_cpp&#x27;;
import &#x27;ace-builds/src-noconflict/mode-ruby&#x27;;
import &#x27;ace-builds/src-noconflict/mode-python&#x27;;
import &#x27;ace-builds/src-noconflict/theme-ambiance&#x27;;
import &#x27;ace-builds/src-noconflict/theme-github&#x27;;
import &#x27;ace-builds/src-noconflict/theme-chaos&#x27;;
import &#x27;ace-builds/src-noconflict/theme-chrome&#x27;;
import &#x27;ace-builds/src-noconflict/theme-cobalt&#x27;;
import &#x27;ace-builds/src-noconflict/ext-language_tools&#x27;;
import &#x27;ace-builds/src-noconflict/ext-beautify&#x27;;
import { EditorDialogComponent } from &#x27;../editor-dialog/editor-dialog.component&#x27;;
import { FileService } from &#x27;../file.service&#x27;;

import { File } from &#x27;../file&#x27;;
import { Navigation } from &#x27;@angular/router&#x27;;

@Component({
  selector: &#x27;app-editor&#x27;,
  templateUrl: &#x27;./editor.component.html&#x27;,
  styleUrls: [&#x27;./editor.component.scss&#x27;]
})

export class EditorComponent implements AfterViewInit {

  /**Description
   * 
   * The life of the project, the editor component. Its functionality can be studied in 2 parts
   * 
   * 1. Editor :
   * The editor is created using the &quot;Ace&quot; library
   * The view uses ngAfterViewInit which is needed for @ViewChild decorator
   * The code is stored as a formatted string, along with the language and theme
   * 
   * The editor supports basic autocomplete and align (beautify) capabilities
   * The code uses https://medium.com/@ofir3322/create-an-online-ide-with-angular-6-nodejs-part-1-163a939a7929 as a starting point
   * 
   * The project also allows for running files via direct uploads
   * 
   * 2. Directory Structure
   * The directory is stored as a recursive list of objects of class type NavigationModel
   * The structure supports file and folder creation, deletion and renaming
   * Provides a system for modularising code and running with various imports and dependencies
   */

  @ViewChild(&#x27;codeEditor&#x27;) private editor: ElementRef&lt;HTMLElement&gt;;
  private aceEditor : ace.Ace.Editor;
  private editorBeautify;
  public fileString;

  files: File[] &#x3D; [];
  folders: string[] &#x3D; [];
  list: NavigationModel[] &#x3D; [];
  currentfile: NavigationModel &#x3D; {
        title: &#x27;&#x27;,
        isFile: true,
        children: [],
  };
  dirk: string &#x3D; &#x27;.&#x27;;
  form: FormGroup;

  THEME : string &#x3D; &#x27;github&#x27;;
  LANG : string &#x3D; &#x27;c_cpp&#x27;;

  code : string &#x3D; &#x27;&#x27;;
  input : string &#x3D; &#x27;&#x27;;
  output : string &#x3D; &#x27;&#x27;;

  constructor(
    public fb: FormBuilder,
    private runscript : RunService,
    public dialog: MatDialog,
    private fileService: FileService,
    private uservice: LoginService
    ) { 
      this.form &#x3D; this.fb.group({
        script: [null],
        language: [&#x27;&#x27;],
        input: [&#x27;&#x27;]
      });
    }

  ngOnInit() {
      this.getFiles(false,false);
  }

  ngAfterViewInit(): void {
    ace.config.set(&#x27;basePath&#x27;, &#x27;path&#x27;);
    ace.config.set(&quot;fontSize&quot;, &quot;16px&quot;);
    ace.require(&#x27;ace/ext/language_tools&#x27;);
    this.editorBeautify &#x3D; ace.require(&#x27;ace/ext/beautify&#x27;);
    const basicEditorOptions: Partial&lt;ace.Ace.EditorOptions&gt; &#x3D; {
      highlightActiveLine: true,
      minLines: 14,
      maxLines: Infinity,
    };
    const extraEditorOptions &#x3D; {
        enableBasicAutocompletion: true,
        enableLiveAutocompletion: true
    };
    const editorOptions &#x3D; Object.assign(basicEditorOptions, extraEditorOptions);
    this.aceEditor &#x3D; ace.edit(this.editor.nativeElement, editorOptions);
    this.aceEditor.setTheme(&#x27;ace/theme/&#x27;+this.THEME);
    this.aceEditor.session.setMode(&#x27;ace/mode/&#x27;+this.LANG);
    this.aceEditor.session.setValue(
&#x60;#include&lt;bits/stdc++.h&gt;
using namespace std;
int main() {
  cout &lt;&lt; &quot;Hello World&quot; &lt;&lt; endl;
  return 0;
}&#x60;    
    );
  }

  public beautifyContents() {
    if (this.aceEditor &amp;&amp; this.editorBeautify) {
      const session &#x3D; this.aceEditor.getSession();
      this.editorBeautify.beautify(session);
   }
  }

  public updateTheme() {
    this.aceEditor.setTheme(&#x27;ace/theme/&#x27;+this.THEME);
  }

  public updateLang() {
    this.aceEditor.session.setMode(&#x27;ace/mode/&#x27;+this.LANG);
    switch(this.LANG) {
      case &#x27;c_cpp&#x27;: {
        this.aceEditor.session.setValue(
&#x60;#include&lt;bits/stdc++.h&gt;
using namespace std;
int main() {
  cout &lt;&lt; &quot;Hello World&quot; &lt;&lt; endl;
  return 0;
}&#x60;
        );
        break;
      }
      case &#x27;python&#x27;: {
        this.aceEditor.session.setValue(&quot;&quot;);
      }
      case &#x27;ruby&#x27;: {
        this.aceEditor.session.setValue(&quot;&quot;);
      }
    }
  }

  openDialog(text: String, text2:String, rename &#x3D; false,oldName&#x3D;&#x27;&#x27;,url&#x3D;&#x27;&#x27;){
    /**
     * Function creates a pop up component of Editor-dialog to get name of new File/Folder or new name of existing
     */
    var filename;
    let dialogRef &#x3D; this.dialog.open(EditorDialogComponent, {
      data: {filename: filename, text: text, text2: text2}});

    dialogRef.afterClosed().subscribe(result&#x3D;&gt;{
      if(!result){return;}
      console.log(&#x60;Dialog Result: ${result}&#x60;);
      if(!rename){
        if(text &#x3D;&#x3D; &quot;File&quot;) {
          const file: NavigationModel &#x3D; {
            title: result,
            isFile: true,
            children: [],
            url: this.dirk
          }
          this.saveFile(file);
        }
        else {
          const folder: NavigationModel &#x3D; {
            title: result,
            isFile: false,
            children: [],
            url: this.dirk
          }
          this.saveFolder(folder);
        }
      }
      else{
        if(text&#x3D;&#x3D;&quot;File&quot;) {
          this.newNameFile(oldName,result,url)
        }
        else {
          this.newNameFolder(oldName,result,url)
        }
      }
    },err&#x3D;&gt;{
      alert(&quot;An error occurred&quot;);
      console.log(err);
    });
  }

  // ---------------FOLDER EDITINGS---------------------

  insert(url:string): NavigationModel[] {
    /**
     * Create new list of objects containing the obtained files and folders
     * Input:
     *    url - local path address of objects inserted
     */
    var temp: NavigationModel[] &#x3D; []
    for(var folder of this.folders) {
      const item: NavigationModel &#x3D; {
        title: folder,
        isFile: false,
        children: [],
        url: url
      }
      temp.push(item);
    }

    for (var val of this.files) {
      const item: NavigationModel &#x3D; {
        title: val.filename,
        isFile: true,
        children: [],
        file: val,
        url: url
      }
      temp.push(item);
    }

    return temp;
  }

  insertStructure(table: NavigationModel[], dir: string[], url: string): NavigationModel[] {
    /**
     * Insert list of files and folders at given local path location
     * Input:
     *    table - list of objects containing files and folders
     *    dir - list of strings containing individual subdirectory names
     *    url - local path address of objects inserted
     */
    if(dir.length &#x3D;&#x3D; 0) {
      return this.insert(url);
    }

    for(var item of table){
      if(!item.isFile &amp;&amp; item.title&#x3D;&#x3D;dir[0]) {
        dir &#x3D; dir.splice(1);
        item.children &#x3D; this.insertStructure(item.children, dir, url);
        break;
      }
    }
    return table;
  }

  deleteStructure(table: NavigationModel[], dir: string[]): NavigationModel[] {
    /**
     * Deletes all children of the folder but not folder itself
     * Input:
     *    table - list of objects containing files and folders
     *    dir - list of strings containing individual subdirectory names
     */
    console.log(dir);
    if(dir.length &#x3D;&#x3D; 0) {
      var empty: NavigationModel[] &#x3D; [];
      return empty;
    }

    for(var item of table){
      if(!item.isFile &amp;&amp; item.title&#x3D;&#x3D;&#x3D;dir[0]) {
        dir &#x3D; dir.splice(1);
        item.children &#x3D; this.deleteStructure(item.children, dir);
      }
    }
    return table;
  }

  deleteFolderStruc(table: NavigationModel[], dir: string[], folder: string): NavigationModel[] {
    /**
     * Deletes folder and all its children
     * Input:
     *    table - list of objects containing files and folders
     *    dir - list of strings containing individual subdirectory names
     *    folder - string for name of folder to be deleted
     */
    if(dir.length &#x3D;&#x3D; 0) {
      table &#x3D; table.filter(f&#x3D;&gt; f.isFile ||  f.title !&#x3D; folder)
      return table;
    }

    for(var item of table){
      if(!item.isFile &amp;&amp; item.title&#x3D;&#x3D;dir[0]) {
        dir &#x3D; dir.splice(1);
        item.children &#x3D; this.deleteFolderStruc(item.children, dir, folder);
        break;
      }
    }
    return table;
  }

  editFolder(table: NavigationModel[], dir: string[], folder: string): NavigationModel[] {
    /**
     * Creates new folder and adds to the list of objects this.list
     * Input:
     *    table - list of objects containing files and folders
     *    dir - list of strings containing individual subdirectory names
     *    folder - string for name of new folder
     */
    if(dir.length &#x3D;&#x3D; 0) {
      var item: NavigationModel &#x3D; {
        title: folder,
        isFile: false,
        url: this.dirk,
        children: []
      }
      table.push(item);
      return table;
    }

    for(var item of table){
      if(!item.isFile &amp;&amp; item.title&#x3D;&#x3D;dir[0]) {
        dir &#x3D; dir.splice(1);
        item.children &#x3D; this.editFolder(item.children, dir, folder);
        break;
      }
    }
    return table;
  }

  fixUrl(table: NavigationModel[],url: string): NavigationModel[] {
    /**
     * Fix local path values for al children of renamed folder
     * Input:
     *    table - list of objects containing files and folders
     *    url - name of new url of all objects in table
     */
    console.log(url);
    for(var item of table){
      item.url &#x3D; url;
      if(!item.isFile) {
        item.children &#x3D; this.fixUrl(item.children, url + &quot;/&quot; + item.title)
      }
    }
    return table;
  }

  renameListFolder(table: NavigationModel[], dir: string[], newName: string, oldName: string): NavigationModel[] {
    /**
     * Renames an existing folder and updates local path values to objects in this.list
     * Input:
     *    table - list of objects containing files and folders
     *    dir - list of strings containing individual subdirectory names
     *    newName - string for name of renamed folder
     *    oldName - string for original name of folder
     */
    if(dir.length &#x3D;&#x3D; 0) {
      for(var item of table){
        if(!item.isFile &amp;&amp; item.title &#x3D;&#x3D; oldName){
          item.title &#x3D; newName;
          item.children &#x3D; this.fixUrl(item.children,item.url + &quot;/&quot; + newName);
          break;
        }
      } 
      return table;
    }

    for(var item of table){
      if(!item.isFile &amp;&amp; item.title&#x3D;&#x3D;dir[0]) {
        dir &#x3D; dir.splice(1);
        item.children &#x3D; this.renameListFolder(item.children, dir, newName,oldName);
        break;
      }
    }
    return table;
  }

  saveFolder(foldername: NavigationModel): void{
    /**
     * Function calls FileService method to create new folder on backend database
     * Input:
     *    foldername - object containing folder name and local path location
     */
    this.fileService.saveFile(
      {
        filename: &quot;trash.trash&quot;,
        script: foldername.title
      } as File, this.uservice.getUser(), this.dirk + &quot;/&quot; + foldername.title).subscribe(
      file&#x3D;&gt;{
        console.log(file);

        var dirs: string[] &#x3D; this.dirk.split(&#x27;/&#x27;)
        dirs &#x3D; dirs.splice(1);
        this.list &#x3D; this.editFolder(this.list, dirs, foldername.title);
      },
      err&#x3D;&gt;{
        alert(&quot;An error occurred&quot;);
        console.log(err);
      }); 
  }

  newNameFolder(oldName: string, newName: string, url: string): void {
    /**
     * Function calls FileService method to rename folder on backend database
     * Input:
     *    oldName - string for original name of folder
     *    newName - string for new name of folder
     *    url - local path location for folder
     */
    this.fileService.renameFile(
      {
        newName: newName, 
        oldName: oldName,
        file: false} as RenameFile, url,this.uservice.getUser()).subscribe(
      file&#x3D;&gt;{
        var dirs: string[] &#x3D; url.split(&#x27;/&#x27;)
        dirs &#x3D; dirs.splice(1);
        this.list &#x3D; this.renameListFolder(this.list, dirs, newName, oldName);
      },
      err&#x3D;&gt;{
        alert(&quot;An error occurred&quot;);
        console.log(err);
      });
  }

  // ------------------------ FILE HELPERS -------------------

  deleteFileStruc(table: NavigationModel[], dir: string[], file: File): NavigationModel[] {
    /**
     * Deletes file from this.list of objects
     * Input:
     *    table - list of objects containing files and folders
     *    dir - list of strings containing individual subdirectory names
     *    file - File object containing filename and code script
     */
    if(dir.length &#x3D;&#x3D; 0) {
      table &#x3D; table.filter(f&#x3D;&gt; !f.isFile || f.file !&#x3D; file)
      return table;
    }

    for(var item of table){
      if(!item.isFile &amp;&amp; item.title&#x3D;&#x3D;dir[0]) {
        dir &#x3D; dir.splice(1);
        item.children &#x3D; this.deleteFileStruc(item.children, dir, file);
        break;
      }
    }
    return table;
  }

  editFile(table: NavigationModel[], dir: string[], file: File): NavigationModel[] {
    /**
     * Creates new file and adds to the list of objects this.list
     * Input:
     *    table - list of objects containing files and folders
     *    dir - list of strings containing individual subdirectory names
     *    file - File object containing filename and code script
     */
    if(dir.length &#x3D;&#x3D; 0) {
      var flag: boolean &#x3D; false;
      for(var item of table) {
        if(item.title &#x3D;&#x3D; file.filename){
          item.file &#x3D; file;
          flag &#x3D; true;
          break;
        }
      }
      if(!flag){
        var item: NavigationModel &#x3D; {
          title: file.filename,
          isFile: true,
          url: this.dirk,
          children: [],
          file: file
        }
        table.push(item);
      }
      return table;
    }

    for(var item of table){
      if(!item.isFile &amp;&amp; item.title&#x3D;&#x3D;dir[0]) {
        dir &#x3D; dir.splice(1);
        item.children &#x3D; this.editFile(item.children, dir, file);
        break;
      }
    }
    return table;
  }

  renameListFile(table: NavigationModel[], dir: string[], newName: string, oldName: string): NavigationModel[] {
    /**
     * Renames an existing file in list of objects this.list
     * Input:
     *    table - list of objects containing files and folders
     *    dir - list of strings containing individual subdirectory names
     *    newName - string for name of renamed file
     *    oldName - string for original name of file
     */
    if(dir.length &#x3D;&#x3D; 0) {
      for(var item of table){
        if(item.isFile &amp;&amp; item.title &#x3D;&#x3D; oldName){
          item.title &#x3D; newName;
        }
      }
      return table;
    }

    for(var item of table){
      if(!item.isFile &amp;&amp; item.title&#x3D;&#x3D;dir[0]) {
        dir &#x3D; dir.splice(1);
        item.children &#x3D; this.renameListFile(item.children, dir, newName,oldName);
        break;
      }
    }
    return table;
  }

  saveFile(filename &#x3D; this.currentfile): void{
    /**
     * Function calls FileService method to create new file on backend database
     * Input:
     *    filename - File object containing filename and code script
     */
    if(!filename){
      return this.openDialog(&quot;File&quot;,&quot;Create New File&quot;);
    }
    this.code &#x3D; this.aceEditor.session.getValue();
    this.fileService.saveFile(
      {
        filename: filename.title,
        script: this.code
      } as File, this.uservice.getUser(), this.dirk).subscribe(
      file&#x3D;&gt;{
        console.log(file);

        var dirs: string[] &#x3D; this.dirk.split(&#x27;/&#x27;)
        dirs &#x3D; dirs.splice(1);
        this.list &#x3D; this.editFile(this.list, dirs,file);
        console.log(this.list);
      },err&#x3D;&gt;{
        alert(&quot;An error occurred&quot;);
        console.log(err);
      }); 
  }

  newNameFile(oldName: string, newName: string, url: string): void {
    /**
     * Function calls FileService method to rename file on backend database
     * Input:
     *    oldName - string for original name of file
     *    newName - string for new name of file
     *    url - local path location for file
     */
    this.fileService.renameFile(
      {
        newName: newName, 
        oldName: oldName,
        file: true} as RenameFile, url,this.uservice.getUser()).subscribe(
      file&#x3D;&gt;{
        var dirs: string[] &#x3D; url.split(&#x27;/&#x27;)
        dirs &#x3D; dirs.splice(1);
        this.list &#x3D; this.renameListFile(this.list, dirs, newName, oldName);
      },
      err&#x3D;&gt;{
        alert(&quot;An error occurred&quot;);
        console.log(err);
      });
  }

  getFiles(newFolder: boolean, deleteFolder: boolean): void {
    /**
     * Function executed on ngInit and every time nested folder contents is to be viewed or closed
     * Input:
     *    newFolder - True if nested folder contents is to be viewed
     *    deleteFolder - True if nested folder is closed
     */
    this.fileService.getFiles(this.uservice.getUser(),this.dirk).subscribe(
      files &#x3D;&gt; {this.files&#x3D;files;
      this.folders &#x3D; this.files.filter(f&#x3D;&gt; f.filename &#x3D;&#x3D;&#x3D; &quot;trash.trash&quot;).map(f&#x3D;&gt;f.script)
      this.files &#x3D; this.files.filter(f &#x3D;&gt; f.filename !&#x3D;&#x3D; &quot;trash.trash&quot;);
      if(newFolder) {
        var dirs: string[] &#x3D; this.dirk.split(&#x27;/&#x27;)
        dirs &#x3D; dirs.splice(1);
        this.list &#x3D; this.insertStructure(this.list, dirs,this.dirk);
      }
      else if(deleteFolder) {
        if(this.dirk &#x3D;&#x3D; &#x27;.&#x27;)
          return;
        var dirs: string[] &#x3D; this.dirk.split(&#x27;/&#x27;)
        dirs &#x3D; dirs.splice(1);
        this.list &#x3D; this.deleteStructure(this.list, dirs);
        var loc &#x3D; this.dirk.lastIndexOf(&quot;/&quot;);
        if(loc !&#x3D;&#x3D; -1) {
          this.dirk &#x3D; this.dirk.substring(0,loc);
        }
        console.log(this.dirk);
      }
      else{
        this.list &#x3D; this.insert(this.dirk);
      }
      console.log(this.list);
    },err&#x3D;&gt;{
      alert(&quot;An error occurred&quot;);
      console.log(err);
    }
    );
}

  // ------------------------- LOAD FILE/FOLDER INFORMATION --------------------


  setFile(file: NavigationModel){
    this.currentfile &#x3D; file;
    this.dirk &#x3D; file.url;
    this.aceEditor.session.setValue(file.file.script);
  }

  setFolder(folder: NavigationModel){
    this.dirk &#x3D; folder.url + &quot;/&quot; + folder.title;
    console.log(this.dirk);
    this.getFiles(true,false);
  }

  deleteFile(file: NavigationModel): void {
    this.dirk &#x3D; file.url;
    var dirs: string[] &#x3D; this.dirk.split(&#x27;/&#x27;)
    dirs &#x3D; dirs.splice(1);
    this.list &#x3D; this.deleteFileStruc(this.list,dirs,file.file);
    this.fileService.deleteFile(file.title,this.uservice.getUser(), this.dirk).subscribe(err&#x3D;&gt;{
      alert(&quot;An error occurred&quot;);
      console.log(err);
    });
  }

  deleteFolder(folder: NavigationModel): void {
    this.dirk &#x3D; folder.url;
    var drk: string &#x3D; this.dirk + &quot;/&quot; + folder.title
    var dirs: string[] &#x3D; this.dirk.split(&#x27;/&#x27;)
    dirs &#x3D; dirs.splice(1);
    this.list &#x3D; this.deleteFolderStruc(this.list,dirs, folder.title);
    this.fileService.deleteFolder(this.uservice.getUser(), drk).subscribe(err&#x3D;&gt;{
      alert(&quot;An error occurred&quot;);
      console.log(err);
    });
  }

  renameFile(file: NavigationModel): void {
    this.openDialog(&quot;File&quot;,&quot;Rename File&quot;,true,file.title, file.url);
  }

  renameFolder(folder: NavigationModel): void {
    this.openDialog(&quot;Folder&quot;,&quot;Rename Folder&quot;,true, folder.title, folder.url);
  }

  goBack(): void {
    this.getFiles(false,true);
  }


  // ------------------- EXECUTE CODE OPERATIONS -------------------

  uploadSource(event) {
    const file &#x3D; (event.target as HTMLInputElement).files[0];

    /**
     * Here, we use the typescript FileReader to upload files the same way we upload editor code
     * UPDATE : We would like to render the contents of the file into the editor in the next update
     */
    let fileReader &#x3D; new FileReader();
    fileReader.onloadend &#x3D; (e) &#x3D;&gt; {
      this.fileString &#x3D; fileReader.result;
    }

    /// remove comment to UPDATE :
    /// this.aceEditor.session.setValue(this.fileString); 

    fileReader.readAsText(file)
    
    this.form.patchValue({
      script: this.fileString,
      language: this.LANG,
      input: this.input
    });
    this.form.get(&#x27;script&#x27;).updateValueAndValidity();
    this.form.get(&#x27;language&#x27;).updateValueAndValidity();
    this.form.get(&#x27;input&#x27;).updateValueAndValidity();
  }

  public runCode() {
    /**
     * Executed when the user presses the Run button, this function sends the editor content to the server
     * Along with the code, the &quot;input&quot; contents are also sent to the server
     * The server responds with the output which is rendered in the output textarea
     */
    this.code &#x3D; this.aceEditor.session.getValue();
    const send : RunInput &#x3D; {
      username : this.uservice.getUser(),
      script : this.code,
      language : this.LANG,
      input : this.input
    };
    console.log(send);
    this.runscript.runScript(send,this.uservice.getUser(),this.currentfile.url).subscribe(receivied &#x3D;&gt;
      {
        if(receivied.success&#x3D;&#x3D;true) {
          this.output &#x3D; receivied.output;
        }   
        else {
          this.output &#x3D; &quot;Error: &quot; + receivied.output;
        }
      },err&#x3D;&gt;{
        alert(&quot;An error occurred&quot;);
        console.log(err);
      });
}

  runFile() {
    /**
     * Executed when the user presses the Run File button, this function sends the file content to the server
     * Along with the code, the &quot;input&quot; contents are also sent to the server
     * The server responds with the output which is rendered in the output textarea
     */
    const send : RunInput &#x3D; {
      username : this.uservice.getUser(),
      script : this.fileString,
      language : this.LANG,
      input : this.input
    };
    console.log(send);
    this.runscript.runScript(send,this.uservice.getUser(), &quot;&quot;).subscribe(receivied &#x3D;&gt;
      {
        if(receivied.success&#x3D;&#x3D;true) {
          this.output &#x3D; receivied.output;
        }   
        else {
          this.output &#x3D; &quot;Error: &quot; + receivied.output;
        }
      },err&#x3D;&gt;{
        alert(&quot;An error occurred&quot;);
        console.log(err);
      }); 
  } 
} 

class NavigationModel {
  public title: string;
  public url?: string;
  public isFile: boolean;
  public file?: File;
  public children: NavigationModel[];
}</code></pre>
    </div>
</div>



                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'NavigationModel.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
